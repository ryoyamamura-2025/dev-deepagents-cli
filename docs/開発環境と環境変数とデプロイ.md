\# ç’°å¢ƒå¤‰æ•°ç®¡ç†ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¬ã‚¤ãƒ‰



\## ğŸ“‹ ç›®æ¬¡

1\. \[LangGraphã¸ã®æ¥ç¶šè¨­å®š](#langgraphã¸ã®æ¥ç¶šè¨­å®š)

2\. \[ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†æ–¹æ³•](#ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†æ–¹æ³•)

3\. \[å„ç’°å¢ƒã§ã®è¨­å®šè©³ç´°](#å„ç’°å¢ƒã§ã®è¨­å®šè©³ç´°)

4\. \[ç’°å¢ƒåˆ¥ã®èµ·å‹•æ–¹æ³•](#ç’°å¢ƒåˆ¥ã®èµ·å‹•æ–¹æ³•)

5\. \[ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)



---



\## LangGraphã¸ã®æ¥ç¶šè¨­å®š



\### è³ªå•1: deploymentUrlã«ã¯ä½•ã‚’å…¥åŠ›ã™ã‚Œã°ã„ã„ã‹ï¼Ÿ



ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®LangGraphæ¥ç¶šã«ã¯ã€\*\*ç’°å¢ƒã«å¿œã˜ã¦ç•°ãªã‚‹URL\*\*ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚



\#### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºæ™‚ï¼ˆæ¨å¥¨ï¼‰



```

Deployment URL: http://localhost:8124/agent

Assistant ID: agent

```



\*\*èª¬æ˜:\*\*

\- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã® `file\_main.py` ãŒLangGraphã¸ã®\*\*ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼\*\*ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™

\- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ â†’ `http://localhost:8124/agent` â†’ LangGraph (`http://localhost:2024`)

\- `/agent` ãƒ‘ã‚¹ã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒè‡ªå‹•çš„ã«LangGraphã‚µãƒ¼ãƒãƒ¼ã¸è»¢é€ã—ã¾ã™



\#### LangGraphã«ç›´æ¥æ¥ç¶šã™ã‚‹å ´åˆ



```

Deployment URL: http://localhost:2024

Assistant ID: agent

```



\*\*èª¬æ˜:\*\*

\- LangGraphã‚µãƒ¼ãƒãƒ¼ã«ç›´æ¥æ¥ç¶šã—ã¾ã™

\- `langgraph.json` ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚°ãƒ©ãƒ•å "agent" ã‚’ Assistant ID ã¨ã—ã¦ä½¿ç”¨ã—ã¾ã™



\#### Assistant IDã«ã¤ã„ã¦



`backend/langgraph.json` ã§å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ï¼š



```json

{

&nbsp; "graphs": {

&nbsp;   "agent": "./backend\_agent\_main.py:agent"

&nbsp; }

}

```



\- \*\*Assistant ID = graphå\*\* = `"agent"`

\- ã“ã®åå‰ã¯LangGraphã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã™ã‚‹éš›ã«ä½¿ç”¨ã•ã‚Œã‚‹ã‚°ãƒ©ãƒ•ã®è­˜åˆ¥å­ã§ã™



---



\## ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†æ–¹æ³•



\### è³ªå•2: 3æ®µéšã®ç’°å¢ƒå¤‰æ•°ç®¡ç†ã¯æ­£ã—ã„ã‹ï¼Ÿ



\*\*çµè«–: ã¯ã„ã€ç¾åœ¨ã®æ–¹æ³•ã¯æ­£ã—ãè¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚\*\*



\### ç’°å¢ƒå¤‰æ•°ç®¡ç†ã®å…¨ä½“åƒ



```

ç’°å¢ƒ                    | ä½¿ç”¨ãƒ•ã‚¡ã‚¤ãƒ«              | ç”¨é€”

--------------------|--------------------------|---------------------------

ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º         | frontend/.env.development | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºç”¨

(Docker Compose)    | backend/.env             | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºç”¨

&nbsp;                   | .env.local               | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ

--------------------|--------------------------|---------------------------

ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸   | .env.local               | Dockerå˜ä½“èµ·å‹•æ™‚ã®è¨­å®š

(Dockerå˜ä½“)        |                          |

--------------------|--------------------------|---------------------------

ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤     | .env.yaml                | Cloud Runç”¨ã®ç’°å¢ƒå¤‰æ•°

(GCP Cloud Run)     |                          |

```



\### è¿½è·¡ç®¡ç†ï¼ˆ.gitignoreï¼‰



ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯\*\*ã™ã¹ã¦gitè¿½è·¡å¯¾è±¡å¤–\*\*ã«ãªã£ã¦ã„ã¾ã™ï¼š



```gitignore

\# ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã™ã¹ã¦è¿½è·¡å¯¾è±¡å¤–ï¼‰

.env

.env.development.local

.env.test.local

.env.production.local

.env.local

.env.yaml

```



\*\*ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆè¿½è·¡ã•ã‚Œã‚‹ï¼‰:\*\*

\- `.env.example` - ç’°å¢ƒå¤‰æ•°ã®ã‚µãƒ³ãƒ—ãƒ«

\- `deploy.sh.example` - ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã‚µãƒ³ãƒ—ãƒ«



---



\## å„ç’°å¢ƒã§ã®è¨­å®šè©³ç´°



\### 1ï¸âƒ£ ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºæ™‚ï¼ˆDocker Composeï¼‰



\*\*ä½¿ç”¨ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰:\*\*

```bash

docker-compose up

```



\*\*ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«:\*\*



\#### `docker-compose.yaml` ã®è¨­å®š



```yaml

services:

&nbsp; frontend:

&nbsp;   env\_file:

&nbsp;     - frontend/.env.development

&nbsp;   environment:

&nbsp;     - NEXT\_PUBLIC\_BACKEND\_URL=http://localhost:8124

&nbsp;     - BACKEND\_URL=http://backend:8124



&nbsp; backend:

&nbsp;   env\_file:

&nbsp;     - .env.local

&nbsp;     - backend/.env

&nbsp;   environment:

&nbsp;     - PYTHONUNBUFFERED=1

&nbsp;     - WATCH\_DIR=/app/resource

```



\#### `frontend/.env.development` ï¼ˆä½œæˆãŒå¿…è¦ï¼‰



```env

\# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºç”¨ã®ç’°å¢ƒå¤‰æ•°

NEXT\_PUBLIC\_FILE\_API\_URL=http://localhost:8124

```



\*\*èª¬æ˜:\*\*

\- `NEXT\_PUBLIC\_` ã§å§‹ã¾ã‚‹å¤‰æ•°ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚‚ä½¿ç”¨å¯èƒ½

\- ãƒ•ã‚¡ã‚¤ãƒ«ãƒ–ãƒ©ã‚¦ã‚¶APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’æŒ‡å®š



\#### `backend/.env` ï¼ˆä½œæˆãŒå¿…è¦ï¼‰



```env

\# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºç”¨ã®ç’°å¢ƒå¤‰æ•°

WORKING\_DIR=/app/resource

SKILL\_DIR=/root/.deepagents/agent/skills

CORS\_ORIGINS=http://localhost:3000,http://localhost:8124

```



\#### `.env.local` ï¼ˆãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã€ä½œæˆãŒå¿…è¦ï¼‰



```env

\# GCPèªè¨¼æƒ…å ±ãªã©ã€æ©Ÿå¯†æƒ…å ±ã‚’å«ã‚€è¨­å®š

GOOGLE\_APPLICATION\_CREDENTIALS=/path/to/credentials.json

GOOGLE\_CLOUD\_PROJECT=your-project-id

GOOGLE\_CLOUD\_LOCATION=global

GOOGLE\_GENAI\_USE\_VERTEXAI=TRUE

GOOGLE\_API\_KEY=your-api-key

GOOGLE\_MODEL=gemini-2.5-flash



\# LangGraphè¨­å®š

LANGGRAPH\_API\_URL=http://localhost:2024



\# ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è¨­å®š

WORKING\_DIR=/workspace/app

SKILL\_DIR=/root/.deepagents/agent/skills

CORS\_ORIGINS=http://localhost:3000

```



\*\*ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå‚è€ƒ:\*\* `.env.example` ã‚’å‚ç…§ã—ã¦ãã ã•ã„



---



\### 2ï¸âƒ£ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ™‚ï¼ˆDockerå˜ä½“ï¼‰



\*\*ä½¿ç”¨ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰:\*\*

```bash

docker build -t deepagents-app .

docker run -p 8080:8080 --env-file .env.local deepagents-app

```



\*\*ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«:\*\*



\#### `.env.local` ï¼ˆãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰



```env

\# æœ¬ç•ªç’°å¢ƒã«è¿‘ã„å½¢ã§ã®ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œç”¨

GOOGLE\_APPLICATION\_CREDENTIALS=/app/.credentials/credentials.json

GOOGLE\_CLOUD\_PROJECT=your-project-id

GOOGLE\_CLOUD\_LOCATION=global

GOOGLE\_GENAI\_USE\_VERTEXAI=TRUE

GOOGLE\_API\_KEY=your-api-key

GOOGLE\_MODEL=gemini-2.5-flash



\# LangGraphè¨­å®šï¼ˆã‚³ãƒ³ãƒ†ãƒŠå†…éƒ¨ï¼‰

LANGGRAPH\_API\_URL=http://localhost:2024



\# ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è¨­å®š

WORKING\_DIR=/app/workspace

SKILL\_DIR=/root/.deepagents/agent/skills

CORS\_ORIGINS=\*



\# ãƒãƒ¼ãƒˆè¨­å®š

PORT=8080

```



\*\*Dockerfile ã®ç’°å¢ƒå¤‰æ•°:\*\*



```dockerfile

\# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆ.env.localã§ä¸Šæ›¸ãå¯èƒ½ï¼‰

ENV STATIC\_DIR=/app/static-build

ENV LANGGRAPH\_API\_URL=http://localhost:2024

ENV WATCH\_DIR=/app/workspace

ENV PORT=8080

```



---



\### 3ï¸âƒ£ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ï¼ˆGCP Cloud Runï¼‰



\*\*ä½¿ç”¨ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰:\*\*

```bash

./deploy.sh

```



\*\*ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«:\*\*



\#### `.env.yaml` ï¼ˆä½œæˆãŒå¿…è¦ï¼‰



```yaml

\# Cloud Runç”¨ã®ç’°å¢ƒå¤‰æ•°è¨­å®š

GOOGLE\_APPLICATION\_CREDENTIALS: /app/.credentials/credentials.json

GOOGLE\_CLOUD\_PROJECT: your-project-id

GOOGLE\_CLOUD\_LOCATION: global

GOOGLE\_GENAI\_USE\_VERTEXAI: "TRUE"

GOOGLE\_MODEL: gemini-2.5-flash



\# LangGraphè¨­å®š

LANGGRAPH\_API\_URL: http://localhost:2024



\# ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è¨­å®š

WORKING\_DIR: /app/workspace

SKILL\_DIR: /root/.deepagents/agent/skills

CORS\_ORIGINS: https://your-app.run.app



\# ãƒãƒ¼ãƒˆè¨­å®šï¼ˆCloud RunãŒè‡ªå‹•è¨­å®šã™ã‚‹PORTã‚’ä½¿ç”¨ï¼‰

PORT: "8080"

```



\#### `deploy.sh` ï¼ˆdeploy.sh.exampleã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä½œæˆï¼‰



```bash

\#!/usr/bin/env bash

set -euo pipefail



\# ========= åŸ‹ã‚ã‚‹ã¨ã“ã‚ =========

PROJECT\_ID="your-gcp-project-id"

REGION="asia-northeast1"

SERVICE\_NAME="deepagents-app"

MEMORY="4Gi"

\# ================================



echo "ğŸ”¨ Building and pushing to GCR..."

gcloud builds submit \\

&nbsp; --tag gcr.io/${PROJECT\_ID}/${SERVICE\_NAME} \\

&nbsp; --dockerfile Dockerfile



echo "ğŸš€ Deploying to Cloud Run..."

gcloud run deploy ${SERVICE\_NAME} \\

&nbsp; --image gcr.io/${PROJECT\_ID}/${SERVICE\_NAME} \\

&nbsp; --platform managed \\

&nbsp; --no-allow-unauthenticated \\

&nbsp; --region ${REGION} \\

&nbsp; --port 8080 \\

&nbsp; --memory ${MEMORY} \\

&nbsp; --cpu 1 \\

&nbsp; --timeout 300 \\

&nbsp; --env-vars-file="./.env.yaml"



echo "âœ… Deployment complete!"

gcloud run services describe ${SERVICE\_NAME} --region ${REGION} --format 'value(status.url)'

```



---



\## ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã¨ç’°å¢ƒå¤‰æ•°ã®åˆ†é›¢



\### âœ… æ­£ã—ãåˆ†é›¢ã•ã‚Œã¦ã„ã¾ã™



ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã¯ç’°å¢ƒå¤‰æ•°ã‚’é€šã˜ã¦è¨­å®šã‚’èª­ã¿è¾¼ã‚€ãŸã‚ã€\*\*ç’°å¢ƒã«ã‚ˆã£ã¦ã‚³ãƒ¼ãƒ‰ãŒå¤‰ã‚ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“\*\*ã€‚



\#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä¾‹



`frontend/src/app/components/ConfigDialog.tsx`:

```typescript

// ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒUIã§è¨­å®šã‚’å…¥åŠ›

const \[deploymentUrl, setDeploymentUrl] = useState("");

const \[assistantId, setAssistantId] = useState("");

```



\- UIã§è¨­å®šã‚’å…¥åŠ›ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜

\- ã‚³ãƒ¼ãƒ‰ã«ç’°å¢ƒä¾å­˜ã®ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯ãªã—



\#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ä¾‹



`backend/file\_main.py`:

```python

\# ç’°å¢ƒå¤‰æ•°ã‹ã‚‰èª­ã¿è¾¼ã¿ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚ã‚Šï¼‰

LANGGRAPH\_API\_URL = os.getenv("LANGGRAPH\_API\_URL", "http://localhost:2024")

```



\- ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã‚Œã°ãã‚Œã‚’ä½¿ç”¨

\- ãªã‘ã‚Œã°ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ä½¿ç”¨

\- ã‚³ãƒ¼ãƒ‰ã¯ç’°å¢ƒã«ä¾å­˜ã—ãªã„



\#### Dockerfileã®ä¾‹



```dockerfile

\# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®šï¼ˆ.env.localã§ä¸Šæ›¸ãå¯èƒ½ï¼‰

ENV LANGGRAPH\_API\_URL=http://localhost:2024

ENV PORT=8080

```



\- Dockerfileè‡ªä½“ã¯ç’°å¢ƒã«ä¾å­˜ã—ãªã„

\- å®Ÿè¡Œæ™‚ã«ç’°å¢ƒå¤‰æ•°ã§å‹•ä½œã‚’å¤‰æ›´ã§ãã‚‹



---



\## ç’°å¢ƒåˆ¥ã®èµ·å‹•æ–¹æ³•



\### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºï¼ˆDocker Composeï¼‰



```bash

\# 1. ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æº–å‚™

cp .env.example .env.local

\# .env.local ã‚’ç·¨é›†ã—ã¦å¿…è¦ãªå€¤ã‚’è¨­å®š



\# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç”¨ã®.envã‚‚ä½œæˆï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

cat > frontend/.env.development <<EOF

NEXT\_PUBLIC\_FILE\_API\_URL=http://localhost:8124

EOF



\# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç”¨ã®.envã‚‚ä½œæˆï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

cat > backend/.env <<EOF

WORKING\_DIR=/app/resource

SKILL\_DIR=/root/.deepagents/agent/skills

CORS\_ORIGINS=http://localhost:3000,http://localhost:8124

EOF



\# 2. Docker Composeã§èµ·å‹•

docker-compose up



\# 3. ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹

\# http://localhost:3000



\# 4. è¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§å…¥åŠ›

\# Deployment URL: http://localhost:8124/agent

\# Assistant ID: agent

```



\### ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆDockerå˜ä½“ï¼‰



```bash

\# 1. ãƒ“ãƒ«ãƒ‰

docker build -t deepagents-app .



\# 2. èµ·å‹•

docker run -p 8080:8080 --env-file .env.local deepagents-app



\# 3. ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹

\# http://localhost:8080



\# 4. è¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§å…¥åŠ›

\# Deployment URL: http://localhost:8080/agent

\# Assistant ID: agent

```



\### ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆGCP Cloud Runï¼‰



```bash

\# 1. ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æº–å‚™

cp deploy.sh.example deploy.sh

chmod +x deploy.sh

\# deploy.sh ã‚’ç·¨é›†ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDãªã©ã‚’è¨­å®š



\# 2. .env.yamlã‚’ä½œæˆ

cat > .env.yaml <<EOF

GOOGLE\_CLOUD\_PROJECT: your-project-id

GOOGLE\_MODEL: gemini-2.5-flash

LANGGRAPH\_API\_URL: http://localhost:2024

WORKING\_DIR: /app/workspace

CORS\_ORIGINS: https://your-app.run.app

EOF



\# 3. ãƒ‡ãƒ—ãƒ­ã‚¤

./deploy.sh



\# 4. ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸURLã«ã‚¢ã‚¯ã‚»ã‚¹

\# https://deepagents-app-xxxxx.run.app



\# 5. è¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§å…¥åŠ›

\# Deployment URL: https://deepagents-app-xxxxx.run.app/agent

\# Assistant ID: agent

```



---



\## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°



\### LangGraphã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã§ããªã„



\*\*ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:\*\*

```

LangGraph server is not available at http://localhost:2024.

Please ensure langgraph dev is running.

```



\*\*è§£æ±ºæ–¹æ³•:\*\*



1\. \*\*Docker Composeã®å ´åˆ:\*\*

&nbsp;  - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’ç¢ºèª

&nbsp;  ```bash

&nbsp;  docker-compose logs backend

&nbsp;  ```

&nbsp;  - `langgraph dev` ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª



2\. \*\*Dockerå˜ä½“ã®å ´åˆ:\*\*

&nbsp;  - ã‚³ãƒ³ãƒ†ãƒŠå†…ã§LangGraphãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª

&nbsp;  ```bash

&nbsp;  docker exec -it <container-id> bash

&nbsp;  ps aux | grep langgraph

&nbsp;  ```



3\. \*\*ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª:\*\*

&nbsp;  ```bash

&nbsp;  # LANGGRAPH\_API\_URLãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹

&nbsp;  echo $LANGGRAPH\_API\_URL

&nbsp;  ```



\### deploymentUrlã®è¨­å®šãƒŸã‚¹



\*\*ç—‡çŠ¶:\*\* UIã§æ¥ç¶šã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹



\*\*ç¢ºèªäº‹é …:\*\*



1\. \*\*ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºæ™‚:\*\*

&nbsp;  - Deployment URL: `http://localhost:8124/agent`

&nbsp;  - Assistant ID: `agent`



2\. \*\*ãƒãƒ¼ãƒˆç•ªå·ã®ç¢ºèª:\*\*

&nbsp;  - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: 3000ç•ªãƒãƒ¼ãƒˆï¼ˆDocker Composeï¼‰

&nbsp;  - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: 8124ç•ªãƒãƒ¼ãƒˆï¼ˆDocker Composeï¼‰

&nbsp;  - æœ¬ç•ª: 8080ç•ªãƒãƒ¼ãƒˆï¼ˆDockerå˜ä½“/Cloud Runï¼‰



3\. \*\*ãƒ—ãƒ­ã‚­ã‚·ãƒ‘ã‚¹ã®ç¢ºèª:\*\*

&nbsp;  - `/agent` ãƒ‘ã‚¹ãŒãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§æ­£ã—ãå‡¦ç†ã•ã‚Œã¦ã„ã‚‹ã‹

&nbsp;  - `file\_main.py` ã® `@app.api\_route("/agent/{path:path}")` ã‚’ç¢ºèª



\### ç’°å¢ƒå¤‰æ•°ãŒåæ˜ ã•ã‚Œãªã„



\*\*è§£æ±ºæ–¹æ³•:\*\*



1\. \*\*Docker Composeã®å ´åˆ:\*\*

&nbsp;  ```bash

&nbsp;  # ã‚³ãƒ³ãƒ†ãƒŠã‚’å†ãƒ“ãƒ«ãƒ‰

&nbsp;  docker-compose down

&nbsp;  docker-compose up --build

&nbsp;  ```



2\. \*\*Dockerå˜ä½“ã®å ´åˆ:\*\*

&nbsp;  ```bash

&nbsp;  # ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å†ãƒ“ãƒ«ãƒ‰

&nbsp;  docker build -t deepagents-app . --no-cache

&nbsp;  docker run -p 8080:8080 --env-file .env.local deepagents-app

&nbsp;  ```



3\. \*\*ç’°å¢ƒå¤‰æ•°ã®å„ªå…ˆé †ä½ã‚’ç¢ºèª:\*\*

&nbsp;  - Docker Composeã® `environment` > `env\_file`

&nbsp;  - Dockerfileã® `ENV` < `docker run --env-file`



\### CORSã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹



\*\*ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:\*\*

```

Access to fetch at 'http://localhost:8124/api/files' from origin

'http://localhost:3000' has been blocked by CORS policy

```



\*\*è§£æ±ºæ–¹æ³•:\*\*



1\. \*\*backend/.env ã¾ãŸã¯ .env.local ã‚’ç¢ºèª:\*\*

&nbsp;  ```env

&nbsp;  CORS\_ORIGINS=http://localhost:3000,http://localhost:8124

&nbsp;  ```



2\. \*\*æœ¬ç•ªç’°å¢ƒã®å ´åˆ:\*\*

&nbsp;  ```yaml

&nbsp;  # .env.yaml

&nbsp;  CORS\_ORIGINS: https://your-app.run.app

&nbsp;  ```



3\. \*\*é–‹ç™ºç’°å¢ƒã§å…¨ã¦è¨±å¯ã™ã‚‹å ´åˆ:\*\*

&nbsp;  ```env

&nbsp;  CORS\_ORIGINS=\*

&nbsp;  ```



---



\## ã¾ã¨ã‚



\### deploymentUrlã®æŒ‡å®š



| ç’°å¢ƒ | Deployment URL | Assistant ID |

|------|---------------|---------------|

| ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºï¼ˆæ¨å¥¨ï¼‰ | `http://localhost:8124/agent` | `agent` |

| ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºï¼ˆç›´æ¥ï¼‰ | `http://localhost:2024` | `agent` |

| ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | `http://localhost:8080/agent` | `agent` |

| Cloud Run | `https://your-app.run.app/agent` | `agent` |



\### ç’°å¢ƒå¤‰æ•°ç®¡ç†



| ç’°å¢ƒ | ãƒ•ã‚¡ã‚¤ãƒ« | è¿½è·¡ |

|------|---------|------|

| ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º | `frontend/.env.development` | âŒ |

| ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º | `backend/.env` | âŒ |

| å…¨ç’°å¢ƒ | `.env.local` | âŒ |

| Cloud Run | `.env.yaml` | âŒ |

| ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ | `.env.example` | âœ… |

| ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆ | `deploy.sh.example` | âœ… |



\### ç’°å¢ƒå¤‰æ•°ã®åˆ†é›¢



âœ… \*\*ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã¯ç’°å¢ƒå¤‰æ•°ã§è¨­å®šã‚’èª­ã¿è¾¼ã‚€\*\*

\- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: UIã§è¨­å®šã‚’å…¥åŠ› â†’ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜

\- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: `os.getenv()` ã§ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã¿

\- Docker: `ENV` ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®šã€èµ·å‹•æ™‚ã«ä¸Šæ›¸ãå¯èƒ½



âœ… \*\*ç’°å¢ƒã«ã‚ˆã£ã¦ã‚³ãƒ¼ãƒ‰ãŒå¤‰ã‚ã‚‹ã“ã¨ã¯ãªã„\*\*

\- ã™ã¹ã¦ã®ç’°å¢ƒã§åŒã˜Dockerfileã¨ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ç”¨

\- å®Ÿè¡Œæ™‚ã®ç’°å¢ƒå¤‰æ•°ã§å‹•ä½œã‚’å¤‰æ›´



ã“ã®è¨­è¨ˆã«ã‚ˆã‚Šã€é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆãƒ»æœ¬ç•ªç’°å¢ƒã§ä¸€è²«ã—ãŸå‹•ä½œã‚’ä¿ã¡ã¤ã¤ã€ç’°å¢ƒã”ã¨ã®è¨­å®šã‚’æŸ”è»Ÿã«å¤‰æ›´ã§ãã¾ã™ã€‚

